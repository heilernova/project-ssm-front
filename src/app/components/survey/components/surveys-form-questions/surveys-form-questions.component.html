<form class="form-questions" [formGroup]="form" (ngSubmit)="send()">
    <ol class="questions-list">
        <li class="question" *ngFor="let ques of questions; let i = index">
            <div class="index">
                <div>
                    {{(i + 1).toString().padStart(2, '0')}}
                </div>
            </div>
            <div class="content">
                <div class="text">{{ques.question}}</div>
                <ng-container *ngIf="!ques.responseOptionOther; else others">
                    <mat-radio-group [formControlName]="ques.formControlName ?? ''">
                        <mat-radio-button *ngFor="let item of ques.response;" [value]="item.code">{{item.text}}</mat-radio-button>
                    </mat-radio-group>
                </ng-container>

                <ng-template #others>
                    <app-my-radio [options]="ques.response" (emitValue)="setValue(ques.formControlName ?? '', $event)"></app-my-radio>
                </ng-template>
            
                <!-- Sub encuentas -->
                <ng-container class="sub-questions" *ngIf="ques.subquestions">
                    <ol class="questions-list">
                        <li class="question" *ngFor="let subq of ques.subquestions; let i = index">
                            <div class="index">
                                <div>{{(i + 1).toString().padStart(2, '0')}}</div>
                            </div>
                            <div class="content">
                                <div class="text">{{subq.question}}</div>
                                <mat-radio-group [formControlName]="subq.formControlName ?? ''">
                                    <mat-radio-button *ngFor="let item of subq.response;" [value]="item.code" >{{item.text}}</mat-radio-button>
                                </mat-radio-group>
                            </div>
                            <div class="valid">
                                <mat-icon [ngClass]="formControlValid(subq.formControlName ?? '') ? 'si' : 'no'">{{formControlValid(subq.formControlName ?? '') ? 'check' : 'close'}}</mat-icon>
                            </div>
                        </li>
                    </ol>
                </ng-container>
            </div>
            <div class="valid">
                <mat-icon [ngClass]="formControlValid(ques.formControlName ?? '') ? 'si' : 'no'">{{formControlValid(ques.formControlName ?? '') ? 'check' : 'close'}}</mat-icon>
            </div>
        </li>
    </ol>
    <div class="actions">
        <button [disabled]="form.invalid" mat-stroked-button color="primary">Guardar encuesta</button>
        <div class="note-error"  [ngClass]="form.valid ? 'hidden' :''">
            Falta campos por diligenciar
        </div>
    </div>
</form>

